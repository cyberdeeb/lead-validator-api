{% extends "api/base.html" %} 
{% block title %}Dashboard{% endblock %} 
{% block content %} 
<section>
  <h2 class="title is-3 m-5 has-text-centered"> API Usage </h2>

  <h3 class="title is-4 m-5 has-text-centered">Welcome {{ user.username }}!</h3>
</section>
{% if messages %}
<section>
  {% for message in messages %}
  <div class="notification {{ message.tags }}">
    {{ message }}
  </div>
  {% endfor %}
</section>
{% endif %}
<section class="is-flex is-justify-content-center m-5">
  <table class="table">
      <tr>
        <th>API Prefix</th>
        <th>Created</th>
        <th>Last Used</th>
        <th>Request Count</th>
        <th>Bulk Request Count</th>
        <th>Actions</th>
      </tr>
      {% for key in api_keys %}
      <tr>
        <td>{{ key.prefix }}</td>
        <td>{{ key.created_at }}</td>
        <td>{{ key.last_used_at }}</td>
        <td>{{ key.regular_request_count }}</td>
        <td>{{ key.bulk_request_count }}</td>
        <td>
          <form method="post" action="{% url 'regenerate' %}">
            {% csrf_token %}
            <button type="submit" class="is-button is-small is-warning">Regenerate</button>
          </form>
        </td>
      </tr>
      {% empty %}
      <tr>
          <td colspan="6" class="has-text-centered">You don't have an API key yet.</td>
      </tr>
      <tr>
         <td colspan="6" class="has-text-centered">
          <form method="post" action="{% url 'generate' %}">
            {% csrf_token %}
            <button type="submit" class="button is-link mt-1">Regenerate</button>
          </form>
         </td>
      </tr>
      {% endfor %}
    </table>
</section>

{% endblock %}