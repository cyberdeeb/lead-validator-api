{% extends "api/base.html" %}
{% load static %}
{% block title %}API Documentation - Lead Verifier{% endblock %}
{% block content %}

<section class="section">
    <div class="container">
        <h1 class="title is-2 has-text-centered mb-6">API Documentation</h1>
        <p class="subtitle is-4 has-text-centered mb-6">
            Complete guide to using the Lead Verification API
        </p>

        <!-- Quick Start -->
        <div class="box mb-6">
            <h2 class="title is-3">üöÄ Quick Start</h2>
            <div class="content">
                <ol>
                    <li><strong>Sign up</strong> for an account at <a href="{% url 'signup' %}">Sign Up</a></li>
                    <li><strong>Generate</strong> your API key from the <a href="{% url 'dashboard' %}">Dashboard</a>
                    </li>
                    <li><strong>Include</strong> your API key in the <code>X-API-Key</code> header</li>
                    <li><strong>Start verifying</strong> leads with our endpoints!</li>
                </ol>
            </div>
        </div>

        <!-- Authentication -->
        <div class="box mb-6">
            <h2 class="title is-3">üîê Authentication</h2>
            <div class="content">
                <p>All API requests require authentication using an API key in the request header:</p>
                <pre class="has-background-light p-4"><code>X-API-Key: your-api-key-here</code></pre>
                <div class="notification is-info">
                    <strong>Note:</strong> You must be a registered user to access the API endpoints.
                </div>
            </div>
        </div>

        <!-- Rate Limits -->
        <div class="box mb-6">
            <h2 class="title is-3">‚è±Ô∏è Rate Limits</h2>
            <div class="content">
                <div class="columns">
                    <div class="column">
                        <h4 class="title is-5">Current Limits:</h4>
                        <ul>
                            <li><strong>Authenticated Users:</strong> 5 requests per month</li>
                            <li><strong>Burst Protection:</strong> Rate limiting applies</li>
                            <li><strong>Per API Key:</strong> Individual tracking</li>
                        </ul>
                    </div>
                    <div class="column">
                        <div class="notification is-warning">
                            <strong>Portfolio Demo:</strong><br>
                            This is a portfolio project with limited usage to demonstrate functionality.
                            For production use, contact the developer.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Endpoints -->
        <div class="box mb-6">
            <h2 class="title is-3">üì° API Endpoints</h2>

            <!-- Single Verification -->
            <div class="mb-5">
                <h3 class="title is-4">1. Single Lead Verification</h3>
                <div class="has-background-light p-4 mb-3">
                    <strong>POST</strong> <code>https://lead-validator-api-production.up.railway.app/verify/</code>
                </div>
                <p class="mb-3">Verify a single email address and/or phone number.</p>

                <h4 class="title is-5">Request Headers:</h4>
                <pre class="has-background-light p-3 mb-3"><code>Content-Type: application/json
X-API-Key: your-api-key-here</code></pre>

                <h4 class="title is-5">Request Body:</h4>
                <pre class="has-background-light p-3 mb-3"><code>{
    "email": "test@example.com",        // Optional
    "phone_number": "+1234567890"      // Optional
}</code></pre>

                <div class="notification is-info mb-3">
                    <strong>Note:</strong> At least one of <code>email</code> or <code>phone_number</code> is required.
                </div>

                <h4 class="title is-5">Response:</h4>
                <pre class="has-background-light p-3 mb-3"><code>{
    "email": "test@example.com",
    "phone_number": "+1234567890",
    "data": {
        "email_data": {
            "valid": true,
            "score": 85,
            "disposable": false
        },
        "phone_number_data": {
            "valid": true,
            "line_type": "mobile",
            "validation_errors": []
        }
    }
}</code></pre>
            </div>

            <!-- Bulk Verification -->
            <div class="mb-5">
                <h3 class="title is-4">2. Bulk CSV Verification</h3>
                <div class="has-background-light p-4 mb-3">
                    <strong>POST</strong> <code>https://lead-validator-api-production.up.railway.app/bulk-verify/</code>
                </div>
                <p class="mb-3">Upload a CSV file to verify multiple leads at once.</p>

                <h4 class="title is-5">Request Headers:</h4>
                <pre class="has-background-light p-3 mb-3"><code>Content-Type: multipart/form-data
X-API-Key: your-api-key-here</code></pre>

                <h4 class="title is-5">Request Body:</h4>
                <pre class="has-background-light p-3 mb-3"><code>file: your-csv-file.csv</code></pre>

                <h4 class="title is-5">CSV Format:</h4>
                <pre class="has-background-light p-3 mb-3"><code>email,phone_number
test1@example.com,+1234567890
test2@example.com,+0987654321
user@domain.com,+1122334455</code></pre>

                <h4 class="title is-5">Response:</h4>
                <pre class="has-background-light p-3 mb-3"><code>[
    {
        "email": "test1@example.com",
        "phone_number": "+1234567890",
        "data": {
            "email_data": { "valid": true, "score": 85, "disposable": false },
            "phone_number_data": { "valid": true, "line_type": "mobile", "validation_errors": [] }
        }
    },
    // ... more results
]</code></pre>
            </div>
        </div>

        <!-- Error Responses -->
        <div class="box mb-6">
            <h2 class="title is-3">‚ùå Error Responses</h2>
            <div class="content">
                <h4 class="title is-5">Common Error Codes:</h4>
                <div class="table-container">
                    <table class="table is-fullwidth">
                        <thead>
                            <tr>
                                <th>Status Code</th>
                                <th>Description</th>
                                <th>Example Response</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="tag is-danger">401</span></td>
                                <td>Invalid or missing API key</td>
                                <td><code>{"detail": "Invalid API Key"}</code></td>
                            </tr>
                            <tr>
                                <td><span class="tag is-warning">400</span></td>
                                <td>Bad request (validation error)</td>
                                <td><code>{"error": "Either email or phone number are required"}</code></td>
                            </tr>
                            <tr>
                                <td><span class="tag is-warning">429</span></td>
                                <td>Rate limit exceeded</td>
                                <td><code>{"detail": "Request was throttled"}</code></td>
                            </tr>
                            <tr>
                                <td><span class="tag is-danger">500</span></td>
                                <td>Server error</td>
                                <td><code>{"error": "Internal server error"}</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Code Examples -->
        <div class="box mb-6">
            <h2 class="title is-3">üíª Code Examples</h2>

            <!-- Python Example -->
            <div class="mb-5">
                <h4 class="title is-5">Python (requests)</h4>
                <pre class="has-background-light p-4"><code>import requests

# Single verification
url = "https://lead-validator-api-production.up.railway.app/verify/"
headers = {
    "Content-Type": "application/json",
    "X-API-Key": "your-api-key-here"
}
data = {
    "email": "test@example.com",
    "phone_number": "+1234567890"
}

response = requests.post(url, json=data, headers=headers)
result = response.json()
print(result)</code></pre>
            </div>

            <!-- JavaScript Example -->
            <div class="mb-5">
                <h4 class="title is-5">JavaScript (fetch)</h4>
                <pre class="has-background-light p-4"><code>// Single verification
const response = await fetch('https://lead-validator-api-production.up.railway.app/verify/', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-API-Key': 'your-api-key-here'
    },
    body: JSON.stringify({
        email: 'test@example.com',
        phone_number: '+1234567890'
    })
});

const result = await response.json();
console.log(result);</code></pre>
            </div>

            <!-- cURL Example -->
            <div class="mb-5">
                <h4 class="title is-5">cURL</h4>
                <pre class="has-background-light p-4"><code># Single verification
curl -X POST "https://lead-validator-api-production.up.railway.app/verify/" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key-here" \
  -d '{
    "email": "test@example.com",
    "phone_number": "+1234567890"
  }'

# CSV upload
curl -X POST "https://lead-validator-api-production.up.railway.app/bulk-verify/" \
  -H "X-API-Key: your-api-key-here" \
  -F "file=@leads.csv"</code></pre>
            </div>
        </div>

        <!-- Response Data -->
        <div class="box mb-6">
            <h2 class="title is-3">üìä Response Data Explained</h2>
            <div class="content">
                <h4 class="title is-5">Email Verification Fields:</h4>
                <ul>
                    <li><strong>valid:</strong> Boolean indicating if the email is valid</li>
                    <li><strong>score:</strong> Confidence score (0-100) for email validity</li>
                    <li><strong>disposable:</strong> Boolean indicating if it's a disposable email</li>
                </ul>

                <h4 class="title is-5">Phone Number Verification Fields:</h4>
                <ul>
                    <li><strong>valid:</strong> Boolean indicating if the phone number is valid</li>
                    <li><strong>line_type:</strong> Type of phone line (mobile, landline, etc.)</li>
                    <li><strong>validation_errors:</strong> Array of any validation errors found</li>
                </ul>
            </div>
        </div>

        <!-- Best Practices -->
        <div class="box mb-6">
            <h2 class="title is-3">‚úÖ Best Practices</h2>
            <div class="content">
                <ul>
                    <li><strong>Store your API key securely</strong> - Never expose it in client-side code</li>
                    <li><strong>Handle rate limits gracefully</strong> - Implement proper retry logic</li>
                    <li><strong>Validate input data</strong> - Ensure proper email/phone formats before API calls</li>
                    <li><strong>Use bulk verification</strong> - For multiple leads, use CSV upload for efficiency</li>
                    <li><strong>Monitor your usage</strong> - Check your dashboard for request counts</li>
                </ul>
            </div>
        </div>

        <!-- Support -->
        <div class="box">
            <h2 class="title is-3">üÜò Support</h2>
            <div class="content">
                <p>This is a portfolio project created by <strong>Abraham Deeb</strong>.</p>
                <div class="notification is-info">
                    <p><strong>Need help?</strong> This API is designed for demonstration purposes.
                        For questions about implementation or to discuss production usage,
                        please contact the developer.</p>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}